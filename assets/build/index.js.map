{"version":3,"file":"index.js","mappings":"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","sources":["webpack://logdash/./assets/src/IpDetails.jsx","webpack://logdash/external window [\"wp\",\"element\"]","webpack://logdash/webpack/bootstrap","webpack://logdash/webpack/runtime/compat get default export","webpack://logdash/webpack/runtime/define property getters","webpack://logdash/webpack/runtime/hasOwnProperty shorthand","webpack://logdash/./assets/src/index.js"],"sourcesContent":["import {useState} from '@wordpress/element';\n\nconst IpDetails = (props) => {\n    const [isShown, setIsShown] = useState(false);\n    const [error, setError] = useState(null);\n    const [details, setDetails] = useState(null);\n    const loadAndShow = () => {\n\n        if (sessionStorage.getItem(props.address)) {\n\n            const storedDetails = sessionStorage.getItem(props.address);\n            setDetails(JSON.parse(storedDetails));\n            setIsShown(true);\n\n        } else {\n            fetch(wpApiSettings.root + 'logdash/v1/ip/' + props.address, {\n                method: 'get',\n                mode: 'cors',\n                headers: {\n                    'Access-Control-Allow-Origin': '*',\n                    'X-WP-Nonce': wpApiSettings.nonce\n                }\n            })\n                .then(response => response.json())\n                .then(response => {\n                    if (response.code === 'rest_forbidden') {\n                        return Promise.reject(response);\n                    }\n                    if (response.code) {\n                        return Promise.reject({code: 'error', message: 'There is an error.'});\n                    }\n                    return response;\n                })\n                .then(data => {\n                    setDetails(data);\n                    sessionStorage.setItem(props.address, JSON.stringify(data));\n                    return data;\n                })\n                .catch((response) => {\n                    setError(response.message);\n                })\n                .finally(() => setIsShown(true));\n\n        }\n\n    }\n\n    const viewDetails = () => {\n        if (error) {\n            return (\n                <ul>\n                    <li>{error}</li>\n                </ul>\n            )\n        } else {\n            return (\n                <ul>\n                    <li>\n                        <b>City:</b> {details.city.names.en}, {details.subdivisions[0].names.en}, {details.subdivisions[0].iso_code}\n                    </li>\n                    <li><b>Country:</b> {details.country.names.en}, {details.country.is_code}</li>\n                    <li><b>Latitude:</b> {details.location.latitude}</li>\n                    <li><b>Longitude:</b> {details.location.longitude}</li>\n                    <li><b>Provider:</b> {details.traits.isp}</li>\n                </ul>\n            )\n        }\n    }\n\n    return (\n        <div\n            onMouseLeave={() => setIsShown(false)}>\n            <div onClick={loadAndShow} className={'label'}>\n                <span className={'ip'}>{props.address}</span>\n                <span className={'more'}><svg viewBox=\"0 0 512 512\" width={14}><path\n                    d=\"M256 48a208 208 0 1 1 0 416 208 208 0 1 1 0-416zm0 464A256 256 0 1 0 256 0a256 256 0 1 0 0 512zM216 336c-13.3 0-24 10.7-24 24s10.7 24 24 24h80c13.3 0 24-10.7 24-24s-10.7-24-24-24h-8V248c0-13.3-10.7-24-24-24H216c-13.3 0-24 10.7-24 24s10.7 24 24 24h24v64H216zm40-144a32 32 0 1 0 0-64 32 32 0 1 0 0 64z\"/></svg></span>\n            </div>\n            {isShown && (\n                <div className={'details'}>\n                    <h2>Details for IP: {props.address}</h2>\n                    {viewDetails()}\n                </div>\n            )}\n        </div>\n    );\n};\nexport default IpDetails;","module.exports = window[\"wp\"][\"element\"];","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = function(module) {\n\tvar getter = module && module.__esModule ?\n\t\tfunction() { return module['default']; } :\n\t\tfunction() { return module; };\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","const {render} = wp.element; //we are using wp.element here!\nimport './index.scss'\n\nimport IpDetails from \"./IpDetails\";\n\ndocument.querySelectorAll('td.user_ip').forEach(function (item) {\n    const linkItem = item.querySelector('.ip-info[data-ip]');\n    const infoWrapper = item.querySelector('.ip-info-wrapper');\n\n    if (linkItem !== null) {\n        const ip = linkItem.getAttribute('data-ip');\n\n        if (ip !== null) {\n            render(<IpDetails address={ip}/>, infoWrapper);\n        }\n    }\n});\n\ndocument.addEventListener('DOMContentLoaded', () => {\n    expandEventDetails();\n    resetLog();\n});\n\nfunction expandEventDetails() {\n\n\n    const eventCells = document.querySelectorAll('.column-event_meta');\n\n    if (eventCells) {\n\n        eventCells.forEach((cell) => {\n\n            const eventActions = cell.querySelector('.event_actions');\n            const eventDetails = cell.querySelector('.event_details');\n\n            if (eventActions) {\n\n                const detailsBtn = eventActions.querySelector('.details');\n\n                if (detailsBtn) {\n\n                    detailsBtn.addEventListener('click', () => {\n\n                        if (!detailsBtn.classList.contains('active')) {\n                            detailsBtn.classList.add('active');\n                            eventDetails.classList.add('active');\n                        } else {\n                            detailsBtn.classList.remove('active');\n                            eventDetails.classList.remove('active');\n                        }\n\n                    })\n                }\n\n            }\n\n        })\n\n    }\n\n}\n\nfunction resetLog() {\n\n    const reset_log_anchor = document.getElementById('logdash_reset_log');\n\n    if (reset_log_anchor) {\n\n        const message_element = document.getElementById('logdash_message');\n        const message = createElement('p');\n\n        reset_log_anchor.addEventListener('click', (e) => {\n\n            e.preventDefault();\n\n            if (confirm(reset_log_anchor.dataset.confirmMessage) === true) {\n\n                const url = reset_log_anchor.getAttribute('href');\n\n                fetch(url, {\n                    method: 'post',\n                    body: '',\n                    headers: {\n                        'Accept': 'application/json',\n                        'Content-Type': 'application/json'\n                    }\n                }).then((response) => {\n                    return response.json()\n                }).then((res) => {\n                    if (res.status !== 'success') {\n                        throw new Error(res.message);\n                    } else {\n                        displaySuccess(res.message);\n                    }\n                }).catch((error) => {\n                    displayError(error);\n                })\n            }\n        })\n    }\n\n    function displayMessage(message, type) {\n        const message_element = document.getElementById('logdash_message');\n\n        message_element.style.display = 'block';\n        message_element.classList.remove('notice-error', 'notice-success', 'notice-warning', 'notice-info');\n        message_element.classList.add(type);\n        message_element.querySelector('p').innerHTML = message;\n    }\n\n    function displaySuccess(message) {\n        console.log(message);\n        displayMessage(message, 'notice-success');\n    }\n\n    function displayError(message) {\n        displayMessage(message, 'notice-error');\n    }\n\n}"],"names":["props","isShown","setIsShown","useState","error","setError","details","setDetails","createElement","onMouseLeave","onClick","loadAndShow","sessionStorage","getItem","address","storedDetails","JSON","parse","fetch","wpApiSettings","root","method","mode","headers","nonce","then","response","json","code","Promise","reject","message","data","setItem","stringify","catch","finally","className","viewBox","width","d","city","names","en","subdivisions","iso_code","country","is_code","location","latitude","longitude","traits","isp","module","exports","window","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","__webpack_modules__","n","getter","__esModule","a","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","render","wp","element","document","querySelectorAll","forEach","item","linkItem","querySelector","infoWrapper","ip","getAttribute","IpDetails","addEventListener","eventCells","cell","eventActions","eventDetails","detailsBtn","classList","contains","remove","add","expandEventDetails","reset_log_anchor","getElementById","displayMessage","type","message_element","style","display","innerHTML","e","preventDefault","confirm","dataset","confirmMessage","url","body","res","status","Error","console","log","resetLog"],"sourceRoot":""}